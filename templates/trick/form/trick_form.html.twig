{{ form_start(form) }}

<div class="form-group col-8" xmlns="http://www.w3.org/1999/html">
    {{ form_row(form.title, {'label': 'Titre', 'attr': {'placeholder': 'Titre de la figure...'}}) }}
    {{ form_row(form.description, {'label': 'Description', 'attr': {'placeholder': 'Description de la figure...'}}) }}
    {{ form_row(form.category) }}
</div>

{% if trick.pictures is not empty %}
    <div class="form-group col-8 d-flex">
        {% for picture in trick.pictures %}
            <div class="">
                <img src="{{ asset('uploads/pictures/' ~ picture.path) }}" style="width: 100px;">
                <div class="">
                    <a href=" " data-toggle="tooltip" data-placement="top" title="Supprimer la photo">
                        <i class="fas fa-trash-alt"></i>
                    </a>
                </div>
            </div>
        {% endfor %}
    </div>
{% endif %}
<ul class="tags" data-prototype="{{ form_widget(form.pictures.vars.prototype)|e('html_attr') }}"></ul>
<button type="button" class="add_item_link" data-collection-holder-class="tags">Ajouter une image</button>

<br><br>
<button type="submit" class="btn btn-success">Enregistrer</button>
{{ form_end(form) }}

<script
        src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous">
</script>

<script>
    jQuery(document).ready(function() {
        var $tagsCollectionHolder = $('ul.tags');

        $tagsCollectionHolder.data('index', $tagsCollectionHolder.find('input').length);

        $('body').on('click', '.add_item_link', function(e) {
            var $collectionHolderClass = $(e.currentTarget).data('collectionHolderClass');
            addFormToCollection($collectionHolderClass);
        })
    });

    function addFormToCollection($collectionHolderClass) {

        var $collectionHolder = $('.' + $collectionHolderClass);

        var prototype = $collectionHolder.data('prototype');

        var index = $collectionHolder.data('index');

        var newForm = prototype;

        newForm = newForm.replace(/__name__/g, index);

        $collectionHolder.data('index', index + 1);

        var $newFormLi = $('<li></li>').append(newForm);
        $collectionHolder.append($newFormLi)

        //addTagFormDeleteLink($newFormLi);
    }

    jQuery(document).ready(function() {
        $collectionHolder = $('ul.tags');

        $collectionHolder.find('li').each(function() {
            //addTagFormDeleteLink($(this));
        });

    });

    //function addTagFormDeleteLink($tagFormLi) {
        var removeFormButton = document.querySelectorAll('fas.fa-trash-alt');

        //console.log(typeof(removeFormButton));

       // $tagFormLi.append($removeFormButton);

        removeFormButton.forEach((element)=>{
            console.log(element);
            element.on('click', function (e) {
                console.log(document.querySelectorAll(e.target));
                //$tagFormLi.remove();
            });
        });


    //}
</script>

